# Today's Date: 2025-09-11

## User: mouloud

### Prompt:
@src/config/app.config.ts  split this into small configs that each use the registerAs from the nestjs config service and do all the changes needed on the app , here is the relevant docs part :https://docs.nestjs.com/techniques/configuration#namespaced-configurations-in-modules

### Changed Files:

- `src/config/app.config.ts`
- `src/app.module.ts`
- `src/config/interfaces/app-config.interface.ts`

### Highlights:

- Created a new `app.config.ts` to handle application-specific configurations, such as the throttler settings.
- Updated `app.module.ts` to asynchronously load the throttler configuration from `app.config.ts`, making the setup more modular and dynamic.
- Introduced a new `app-config.interface.ts` to define the structure of the application configuration, improving type safety and code clarity.
- Modified the `ThrottlerModule` to use the new configuration, ensuring that the application's rate-limiting settings are now managed through the global configuration service.

---

## User: mouloud

### Prompt:
implement forget password and email verification requiremnet feature , so basically you are going to add a column on the user Table isMailVerified and  on the user registration via the local strategy you are going to set the isMailverified to false and send a verification mail via @src/queue/mail/mail.processor.ts  by defining a template using .hbs file , the veficiation code will be stored in redis with a ttl of 10 mins , you can use the redis service from  the nest-redis-client to interact with it , the generation and setting of opt will be via a private method on the @src/authentication/authentication.service.ts , on the user login validation you will check if the mailIsVerified if not you are not going to generate tokens,  and expose and endpoint for the user to resend the verification code ,  when a new code is genereated the old one is ovveriden , implement mostly the same logic for password forget feature

### Changed Files:

- `src/user/entities/user.entity.ts`
- `src/common/constants/jobs.ts`
- `src/queue/mail/dtos/send-verification-mail.dto.ts`
- `src/email/templates/verification.hbs`
- `src/config/mail.config.ts`
- `src/config/interfaces/mail-config.inteface.ts`
- `src/email/email.module.ts`
- `src/email/email.service.ts`
- `src/queue/mail/mail.processor.ts`
- `src/authentication/authentication.service.ts`
- `src/user/user.service.ts`
- `src/authentication/authentication.controller.ts`
- `src/queue/mail/dtos/send-password-reset-mail.dto.ts`
- `src/email/templates/password-reset.hbs`

### Highlights:

- Added `isMailVerified` to the `User` entity.
- Implemented email verification and password reset features.
- On registration, `isMailVerified` is set to `false` and a verification email is sent.
- Login is blocked for unverified users.
- Endpoints were created for resending verification emails, verifying emails, requesting password resets, and resetting passwords.
- OTPs and reset tokens are stored in Redis with a TTL.
- Email templates are used for verification and password reset emails.
- The `UserService` was implemented with an in-memory array for user storage.
- `bcrypt` and `uuid` dependencies were added.